<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>設定画面</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>設定画面</h1>
    <form id="settingsForm">
      <div class="team-section" style="display: flex; gap: 40px; justify-content: center;">
        <div>
          <h3>Aチーム</h3>
          <div id="teamAInputs"></div>
        </div>
        <div>
          <h3>Bチーム</h3>
          <div id="teamBInputs"></div>
        </div>
      </div>

      <div>
        <p>GMモード：</p>
        <label><input type="radio" name="gmMode" value="yes"> 有り</label>
        <label><input type="radio" name="gmMode" value="no" checked> 無し</label>
      </div>

      <div id="gmSettings" style="display:none;">
        <h3>GMによる役職・タスク設定</h3>
        <div id="gmMemberSettings"></div>
      </div>

      <div id="nogmSettings">
        <h3>大タスク一覧</h3>
        <textarea id="largeTasks" rows="6" cols="60"></textarea>

        <h3>小タスク一覧</h3>
        <textarea id="smallTasks" rows="6" cols="60"></textarea>

        <div style="display: flex; gap: 20px; justify-content: center; margin-top: 1em;">
          <label>大タスク数：<input type="number" id="largeTaskCount" min="0"></label>
          <label>小タスク数：<input type="number" id="smallTaskCount" min="0"></label>
        </div>

        <div style="display: flex; gap: 20px; justify-content: center; margin-top: 1em;">
          <label>村人：<input type="number" id="villagerCount" value="3" min="1" max="4"></label>
          <label>人狼：<input type="number" id="werewolfCount" value="2" min="1" max="4"></label>
        </div>
      </div>

      <div style="margin-top: 20px;">
        <button type="submit">設定</button>
        <button type="button" onclick="window.location.href='index.html'">キャンセル</button>
        <button type="button" id="resetSettings">設定リセット</button>
      </div>
    </form>
  </div>
  <script>
    document.getElementById('settingsForm').addEventListener('submit', async event => {
      event.preventDefault();
  
      const members = []; // Gather input values for members here
      try {
        await fetch('/api/members', { method: 'DELETE' });
        for (const member of members) {
          await fetch('/api/members', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(member),
          });
        }
        alert('設定が保存されました');
      } catch (err) {
        console.error('Failed to save settings', err);
      }
    });
  
    document.getElementById('resetSettings').addEventListener('click', async () => {
      try {
        await fetch('/api/members', { method: 'DELETE' });
        alert('設定がリセットされました');
      } catch (err) {
        console.error('Failed to reset settings', err);
      }
    });
  </script>  
  <script src="script.js"></script>
</body>
</html>
